LOGIN		= `whoami`

# **************************************************************************** #
#                                   BINARIES                                   #
# **************************************************************************** #

NAME		= philo_one

# **************************************************************************** #
#                                  COMPILATION                                 #
# **************************************************************************** #

CC 			= clang
CFLAGS		= -Wall -Wextra -Werror

FSAN		= #-fsanitize=address
DEBUG		= #-g3
OPTI		= #-Ofast

# **************************************************************************** #
#                                 DIRECTORIES                                  #
# **************************************************************************** #

SRCDIR		= srcs
OBJDIR		= .objs
INCDIR		= includes

# **************************************************************************** #
#                                 INCLUDES                                     #
# **************************************************************************** #

# **************************************************************************** #
#                                  SOURCES                                     #
# **************************************************************************** #

SRCS 		=		philo_one.c			\
					philo_one_state.c	\
					init.c

# **************************************************************************** #
#                                   UTILS                                      #
# **************************************************************************** #

OBJS		= $(addprefix $(OBJDIR)/, $(SRCS:.c=.o))

DPDCS		= $(OBJS:.o=.d)

# **************************************************************************** #
#                                   RULES                                      #
# **************************************************************************** #

all				:
	@make -j 4 $(NAME)

$(NAME)			: $(OBJS)

	@$(CC) $(CFLAGS) $(DEBUG) $(OPTI) $(FSAN) -o $@ $^
	@echo "\n\033[36mCreation :\033[0m \033[35;4m$(NAME)\033[0m\n"

-include $(DPDCS)

$(OBJDIR)/%.o	: $(SRCDIR)/%.c | $(OBJDIR)

	@$(CC) $(CFLAGS) $(DEBUG) $(OPTI) $(FSAN) -I $(INCDIR) -MMD -o $@ -c $<
	@echo "\033[36mCompilation :\033[0m \033[32m$*\033[0m"

$(OBJDIR)		:

	@mkdir -p $@			2> /dev/null || true

clean			:

	@rm -rf $(OBJDIR)
	@echo "\n\033[36mDeletion :\033[0m \033[32mObjects\033[0m\n"

fclean			: clean

	@rm -rf $(NAME)
	@echo "\033[36mDeletion :\033[0m \033[35;4m$(NAME)\033[0m\n"

cm				: clean all

re				: fclean all

.PHONY			: all clean fclean cm re
